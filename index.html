<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Caccia al primo indizio</title>

  <style>
    :root{
      /* üé® Palette morbida e bambinesca */
      --ink:#243447;
      --muted:#6b7c8c;

      --primary:#4da3ff;        /* azzurro cielo */
      --primarySoft:#dff1ff;

      --accent:#ffd66b;         /* giallo burro */
      --accentSoft:#fff6d9;

      --mint:#8bd3c7;           /* verde menta tenue */

      --card:#ffffff;
      --border: rgba(36,52,71,.10);

      --okBg:#e6f9f4;
      --okInk:#0f766e;

      --noBg:#fff1f2;
      --noInk:#be123c;

      --radius:22px;
      --shadow:0 12px 28px rgba(0,0,0,.08);

      --max:980px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      min-height:100vh;
      background:#fefefe;
      position:relative;
      overflow-x:hidden;
    }

    /* üå§ Sfondo morbido tipo quaderno */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      z-index:-1;
      background:
        radial-gradient(800px 500px at 15% 10%, var(--primarySoft), transparent 60%),
        radial-gradient(700px 400px at 85% 15%, var(--accentSoft), transparent 60%),
        linear-gradient(180deg, #ffffff 0%, #f8fbff 100%);
    }

    .wrap{
      max-width:var(--max);
      margin:0 auto;
      padding:22px 16px 50px;
    }

    header{
      text-align:center;
      margin-bottom:10px;
    }

    .badge{
      display:inline-block;
      padding:8px 14px;
      border-radius:999px;
      background:var(--primarySoft);
      border:1px solid rgba(77,163,255,.25);
      color:#1e3a8a;
      font-weight:800;
      font-size:13px;
    }

    h1{
      margin:14px 0 8px;
      font-size:clamp(24px,6vw,40px);
      line-height:1.1;
    }

    p.lead{
      margin:0 auto;
      max-width:60ch;
      color:var(--muted);
      font-size:15.5px;
      line-height:1.55;
    }

    main{
      margin-top:20px;
      display:grid;
      gap:20px;
    }

    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      border:1px solid var(--border);
      overflow:hidden;
    }

    .card .hd{
      padding:16px;
      font-weight:900;
      background:linear-gradient(135deg, var(--primarySoft), var(--accentSoft));
      border-bottom:1px solid var(--border);
    }

    .card .bd{
      padding:20px;
      font-size:15px;
      line-height:1.65;
    }

    .task{
      margin-top:16px;
      padding:14px;
      border-radius:16px;
      background:var(--accentSoft);
      border:1px solid rgba(255,214,107,.4);
      font-weight:800;
      color:#92400e;
    }

    .bubble{
      margin-top:18px;
      padding:20px;
      border-radius:20px;
      background:#ffffff;
      border:2px solid var(--mint);
      box-shadow:0 8px 20px rgba(0,0,0,.05);
    }

    .encoded{
      font-size:clamp(20px,6vw,30px);
      font-weight:900;
      text-align:center;
      line-height:1.5;
      letter-spacing:1px;

      padding:16px;
      border-radius:18px;
      background:var(--primarySoft);
      border:2px dashed var(--primary);

      /* ‚úÖ layout che va a capo SOLO tra "parole" */
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:.35em;

      /* non servono pi√π queste */
      word-break: normal;
      overflow-wrap: normal;
      white-space: normal;
    }

    .encoded .w{
      white-space:nowrap; /* ‚úÖ mai a capo dentro la parola */
    }

    .legend{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:10px;
      margin-top:16px;
      font-weight:900;
    }

    .chip{
      padding:8px 12px;
      border-radius:999px;
      background:#f1f5f9;
      border:1px solid rgba(0,0,0,.08);
      font-size:14px;
    }

    textarea{
      width:100%;
      min-height:110px;
      margin-top:16px;
      padding:14px;
      border-radius:18px;
      border:1px solid rgba(36,52,71,.15);
      font-size:16px;
      resize:vertical;
      outline:none;
    }

    textarea:focus{
      border-color:var(--primary);
      box-shadow:0 0 0 4px rgba(77,163,255,.15);
    }

    .btns{
      margin-top:16px;
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }

    button{
      flex:1 1 160px;
      min-height:46px;
      border:none;
      border-radius:16px;
      font-weight:900;
      cursor:pointer;
      color:#1f2937;
      background:linear-gradient(180deg, var(--primary), #2f80ed);
      color:white;
      box-shadow:0 8px 18px rgba(77,163,255,.3);
      transition:.12s ease;
    }

    button:hover{
      transform:translateY(-2px);
    }

    button.reset{
      background:#f1f5f9;
      color:#334155;
      box-shadow:none;
      border:1px solid rgba(0,0,0,.08);
    }

    .msg{
      margin-top:16px;
      padding:14px;
      border-radius:16px;
      font-weight:900;
      display:none;
    }

    .ok{
      display:block;
      background:var(--okBg);
      color:var(--okInk);
    }

    .no{
      display:block;
      background:var(--noBg);
      color:var(--noInk);
    }

    @media (min-width:760px){
      .wrap{ padding:30px 24px 70px; }
      button{ flex:0 0 auto; min-width:180px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="badge">üó∫Ô∏è Gioco a indizi ‚Ä¢ livello 1</div>
      <h1>Caccia al primo indizio</h1>
      <p class="lead">
        Sostituisci le lettere ai simboli e scoprirai cosa ha detto un cristiano molto coraggioso.
      </p>
    </header>

    <main>
      <section class="card">
        <div class="hd">üìú Il racconto</div>
        <div class="bd">
          Nelle terre dell‚Äôimpero romano durante il periodo delle persecuzioni, era vietato ai cristiani professare la propria fede in Ges√π e riunirsi per celebrare la Messa.
          Molti cristiani sono morti per aver partecipato alla Messa contro il volere dell‚Äôimperatore.
          Alcuni di questi sono i martiri di Abitina, uccisi nel 304 d.C.
          Interrogati sul perch√© avessero celebrato la Messa, uno di loro disse una frase molto importante.

          <div class="task">
            Sostituisci le lettere ai simboli e lo scoprirai.<br><br>
            Poi ricopia la frase nella <strong>casella del primo indizio della mappa</strong>.
          </div>

          <div class="bubble">
            <div class="encoded" id="encodedText"></div>

            <div class="legend" aria-label="Legenda simboli">
              <span class="chip">‚ù§Ô∏è = A</span>
              <span class="chip">‚òÄÔ∏è = E</span>
              <span class="chip">‚ùÑÔ∏è = I</span>
              <span class="chip">‚≠ê = O</span>
            </div>

            <textarea id="userAnswer" placeholder="Scrivi qui la frase con le lettere..."></textarea>

            <div class="btns">
              <button id="checkBtn">Controlla</button>
              <button class="reset" id="resetBtn" type="button">Ricomincia</button>
            </div>

            <div id="message" class="msg" role="status" aria-live="polite"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const plain = "Non possiamo vivere senza celebrare il giorno del Signore!";

    const map = {
      "a": "‚ù§Ô∏è", "e": "‚òÄÔ∏è", "i": "‚ùÑÔ∏è", "o": "‚≠ê",
      "A": "‚ù§Ô∏è", "E": "‚òÄÔ∏è", "I": "‚ùÑÔ∏è", "O": "‚≠ê"
    };

    function encode(text){
      let out = "";
      for (const ch of text){
        out += map[ch] ?? ch;
      }
      return out;
    }

    function encodeWords(text){
      // divide in "token": parole e spazi, cos√¨ mantieni anche pi√π spazi se mai servono
      const tokens = text.split(/(\s+)/);

      return tokens.map(t => {
        // se √® solo spazio lo lasciamo cos√¨
        if (/^\s+$/.test(t)) return t;

        // altrimenti codifichiamo e wrappiamo la parola
        const coded = encode(t);
        return `<span class="w">${coded}</span>`;
      }).join("");
    }

    function normalize(s){
      return (s || "")
        .trim()
        .replace(/\s+/g, " ")
        .toLowerCase();
    }

    const encodedEl = document.getElementById("encodedText");
    const userAnswer = document.getElementById("userAnswer");
    const msg = document.getElementById("message");

    encodedEl.innerHTML = encodeWords(plain);

    document.getElementById("checkBtn").addEventListener("click", () => {
      const ok = normalize(userAnswer.value) === normalize(plain);
      msg.style.display = "block";
      msg.className = "msg " + (ok ? "ok" : "no");
      msg.textContent = ok
        ? "Bravissimo/a! üéâ"
        : "Riprova! Guarda bene i simboli üòä";
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      userAnswer.value = "";
      msg.style.display = "none";
    });
  </script>
</body>
</html>
